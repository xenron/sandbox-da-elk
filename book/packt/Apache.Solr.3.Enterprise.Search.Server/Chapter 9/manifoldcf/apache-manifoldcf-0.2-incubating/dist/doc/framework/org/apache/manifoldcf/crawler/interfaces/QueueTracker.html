<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_22) on Tue Apr 26 17:51:19 EDT 2011 -->
<TITLE>
QueueTracker
</TITLE>

<META NAME="keywords" CONTENT="org.apache.manifoldcf.crawler.interfaces.QueueTracker class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="QueueTracker";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/PerformanceStatistics.AveragingRecord.html" title="class in org.apache.manifoldcf.crawler.interfaces"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.BinCount.html" title="class in org.apache.manifoldcf.crawler.interfaces"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?org/apache/manifoldcf/crawler/interfaces/QueueTracker.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="QueueTracker.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.apache.manifoldcf.crawler.interfaces</FONT>
<BR>
Class QueueTracker</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../../resources/inherit.gif" ALT="extended by "><B>org.apache.manifoldcf.crawler.interfaces.QueueTracker</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>QueueTracker</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
This class attempts to provide document priorities in order to acheive as much balance as possible between documents having different bins.
 A document's priority assignment takes place at the time the document is added to the queue, and will be recalculated when a job is aborted, or
 when the crawler daemon is started.  The document priorities are strictly obeyed when documents are chosen from the queue and handed to
 worker threads; higher-priority documents always have precedence, except due to deliberate priority adjustment specified by the job priority.

 The priority values themselves are logarithmic: 0.0 is the highest, and the larger the number, the lower the priority.

 The basis for the calculation for each document priority handed out by this module are:

 - number of documents having a given bin (tracked)
 - performance of a connection (gathered through statistics)
 - throttling that applies to the each document bin


 The queuing prioritization model hooks into the document lifecycle in the following places:
 (1) When a document is added to the queue (and thus when its priority is handed out)
 (2) When documents that were *supposed* to be added to the queue turned out to already be there and already have an established priority,
     (in which case the priority that was handed out before is returned to the pool for reuse)
 (3) When a document is pulled from the database queue (which sets the current highest priority level that should not be exceeded in step (1))

 The assignment prioritization model is largely independent of the queuing prioritization model, and is used to select among documents that have
 been marked "active" as they are handed to worker threads.  These events cause information to be logged:
 (1) When a document is handed to a worker thread
 (2) When the worker thread completes the document
<P>

<P>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->

<A NAME="nested_class_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Nested Class Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.BinCount.html" title="class in org.apache.manifoldcf.crawler.interfaces">QueueTracker.BinCount</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This is the class which allows a mutable integer count value to be saved in the bincount table.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.DoubleBinCount.html" title="class in org.apache.manifoldcf.crawler.interfaces">QueueTracker.DoubleBinCount</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This is the class which allows a mutable integer count value to be saved in the bincount table.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.PriorityKey.html" title="class in org.apache.manifoldcf.crawler.interfaces">QueueTracker.PriorityKey</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This is the key class for the availablePriorities table</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.ThrottleLimits.html" title="class in org.apache.manifoldcf.crawler.interfaces">QueueTracker.ThrottleLimits</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This class represents the throttle limits out of the connection specification</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.ThrottleLimitSpec.html" title="class in org.apache.manifoldcf.crawler.interfaces">QueueTracker.ThrottleLimitSpec</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This is a class which describes an individual throttle limit, in fetches per millisecond.</TD>
</TR>
</TABLE>
&nbsp;<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#_rcsid">_rcsid</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.HashMap</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#activeBinCounts">activeBinCounts</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;These are the bin counts for active threads</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.HashMap</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#availablePriorities">availablePriorities</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This hash table is keyed by PriorityKey objects, and contains ArrayList objects containing Doubles, in sorted order.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.HashMap</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#binCounts">binCounts</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;These are the bin counts for a prioritization pass.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.HashMap</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#binDependencies">binDependencies</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This hash table is keyed by a String (which is the bin name), and contains a HashMap of PriorityKey objects containing that String as a bin</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#binReductionFactor">binReductionFactor</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Factor by which bins are reduced</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#currentMinimumDepth">currentMinimumDepth</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The "minimum depth" - which is the smallest bin count of the last document queued.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/PerformanceStatistics.html" title="class in org.apache.manifoldcf.crawler.interfaces">PerformanceStatistics</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#performanceStatistics">performanceStatistics</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;These are the accumulated performance averages for all connections etc.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.HashMap</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#queuedBinCounts">queuedBinCounts</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;These are the bin counts for tracking the documents that are on
 the active queue, but are not being processed yet</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#resetInProgress">resetInProgress</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This flag, when set, indicates that a reset is in progress, so queuetracker bincount updates are ignored.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#QueueTracker()">QueueTracker</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#addRecord(java.lang.String[])">addRecord</A></B>(java.lang.String[]&nbsp;binNames)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add an access record to the queue tracker.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#assessMinimumDepth(java.lang.Double[])">assessMinimumDepth</A></B>(java.lang.Double[]&nbsp;binNamesSet)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assess the current minimum depth.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#beginProcessing(java.lang.String[])">beginProcessing</A></B>(java.lang.String[]&nbsp;binNames)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note that we are beginning processing for a document with a particular set of bins.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#beginReset()">beginReset</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reset the queue tracker.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#calculateAssignmentRating(java.lang.String[], org.apache.manifoldcf.crawler.interfaces.IRepositoryConnection)">calculateAssignmentRating</A></B>(java.lang.String[]&nbsp;binNames,
                          <A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/IRepositoryConnection.html" title="interface in org.apache.manifoldcf.crawler.interfaces">IRepositoryConnection</A>&nbsp;connection)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculate an assignment rating for a set of bins based on what's currently in use.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#calculateMaxFetchRates(java.lang.String[], org.apache.manifoldcf.crawler.interfaces.IRepositoryConnection)">calculateMaxFetchRates</A></B>(java.lang.String[]&nbsp;binNames,
                       <A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/IRepositoryConnection.html" title="interface in org.apache.manifoldcf.crawler.interfaces">IRepositoryConnection</A>&nbsp;connection)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculate the maximum fetch rate for a given set of bins for a given connection.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#calculatePriority(java.lang.String[], org.apache.manifoldcf.crawler.interfaces.IRepositoryConnection)">calculatePriority</A></B>(java.lang.String[]&nbsp;binNames,
                  <A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/IRepositoryConnection.html" title="interface in org.apache.manifoldcf.crawler.interfaces">IRepositoryConnection</A>&nbsp;connection)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculate a document priority value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#endProcessing(java.lang.String[])">endProcessing</A></B>(java.lang.String[]&nbsp;binNames)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note that we have completed processing of a document with a given set of bins.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#endReset()">endReset</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finish the reset operation</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/PerformanceStatistics.html" title="class in org.apache.manifoldcf.crawler.interfaces">PerformanceStatistics</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#getCurrentStatistics()">getCurrentStatistics</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Obtain the current performance statistics object</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#noteConnectionPerformance(int, java.lang.String, long)">noteConnectionPerformance</A></B>(int&nbsp;docCount,
                          java.lang.String&nbsp;connectionName,
                          long&nbsp;elapsedTime)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note the time required to successfully complete a set of documents.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.html#notePriorityNotUsed(java.lang.String[], org.apache.manifoldcf.crawler.interfaces.IRepositoryConnection, double)">notePriorityNotUsed</A></B>(java.lang.String[]&nbsp;binNames,
                    <A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/IRepositoryConnection.html" title="interface in org.apache.manifoldcf.crawler.interfaces">IRepositoryConnection</A>&nbsp;connection,
                    double&nbsp;priority)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note that a priority which was previously allocated was not used, and needs to be released.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="_rcsid"><!-- --></A><H3>
_rcsid</H3>
<PRE>
public static final java.lang.String <B>_rcsid</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../../constant-values.html#org.apache.manifoldcf.crawler.interfaces.QueueTracker._rcsid">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="binReductionFactor"><!-- --></A><H3>
binReductionFactor</H3>
<PRE>
protected static final double <B>binReductionFactor</B></PRE>
<DL>
<DD>Factor by which bins are reduced
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../../constant-values.html#org.apache.manifoldcf.crawler.interfaces.QueueTracker.binReductionFactor">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="performanceStatistics"><!-- --></A><H3>
performanceStatistics</H3>
<PRE>
protected <A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/PerformanceStatistics.html" title="class in org.apache.manifoldcf.crawler.interfaces">PerformanceStatistics</A> <B>performanceStatistics</B></PRE>
<DL>
<DD>These are the accumulated performance averages for all connections etc.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="binCounts"><!-- --></A><H3>
binCounts</H3>
<PRE>
protected java.util.HashMap <B>binCounts</B></PRE>
<DL>
<DD>These are the bin counts for a prioritization pass.
 This hash table is keyed by bin, and contains DoubleBinCount objects as values
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="queuedBinCounts"><!-- --></A><H3>
queuedBinCounts</H3>
<PRE>
protected java.util.HashMap <B>queuedBinCounts</B></PRE>
<DL>
<DD>These are the bin counts for tracking the documents that are on
 the active queue, but are not being processed yet
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="activeBinCounts"><!-- --></A><H3>
activeBinCounts</H3>
<PRE>
protected java.util.HashMap <B>activeBinCounts</B></PRE>
<DL>
<DD>These are the bin counts for active threads
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="currentMinimumDepth"><!-- --></A><H3>
currentMinimumDepth</H3>
<PRE>
protected double <B>currentMinimumDepth</B></PRE>
<DL>
<DD>The "minimum depth" - which is the smallest bin count of the last document queued.  This helps guarantee that documents that are
 newly discovered don't wind up with high priority, but instead wind up about the same as the currently active document priority.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="resetInProgress"><!-- --></A><H3>
resetInProgress</H3>
<PRE>
protected boolean <B>resetInProgress</B></PRE>
<DL>
<DD>This flag, when set, indicates that a reset is in progress, so queuetracker bincount updates are ignored.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="availablePriorities"><!-- --></A><H3>
availablePriorities</H3>
<PRE>
protected java.util.HashMap <B>availablePriorities</B></PRE>
<DL>
<DD>This hash table is keyed by PriorityKey objects, and contains ArrayList objects containing Doubles, in sorted order.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="binDependencies"><!-- --></A><H3>
binDependencies</H3>
<PRE>
protected java.util.HashMap <B>binDependencies</B></PRE>
<DL>
<DD>This hash table is keyed by a String (which is the bin name), and contains a HashMap of PriorityKey objects containing that String as a bin
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="QueueTracker()"><!-- --></A><H3>
QueueTracker</H3>
<PRE>
public <B>QueueTracker</B>()</PRE>
<DL>
<DD>Constructor
<P>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="beginReset()"><!-- --></A><H3>
beginReset</H3>
<PRE>
public void <B>beginReset</B>()</PRE>
<DL>
<DD>Reset the queue tracker.
 This occurs ONLY when we are about to reprioritize all active documents.  It does not affect the portion of the queue tracker that
 tracks the active queue.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="endReset()"><!-- --></A><H3>
endReset</H3>
<PRE>
public void <B>endReset</B>()</PRE>
<DL>
<DD>Finish the reset operation
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="addRecord(java.lang.String[])"><!-- --></A><H3>
addRecord</H3>
<PRE>
public void <B>addRecord</B>(java.lang.String[]&nbsp;binNames)</PRE>
<DL>
<DD>Add an access record to the queue tracker.  This happens when a document
 is added to the in-memory queue, and allows us to keep track of that particular event so
 we can schedule in a way that meets our distribution goals.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>binNames</CODE> - are the set of bins, as returned from the connector in question, for
 the document that is being queued.  These bins are considered global in nature.</DL>
</DD>
</DL>
<HR>

<A NAME="notePriorityNotUsed(java.lang.String[], org.apache.manifoldcf.crawler.interfaces.IRepositoryConnection, double)"><!-- --></A><H3>
notePriorityNotUsed</H3>
<PRE>
public void <B>notePriorityNotUsed</B>(java.lang.String[]&nbsp;binNames,
                                <A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/IRepositoryConnection.html" title="interface in org.apache.manifoldcf.crawler.interfaces">IRepositoryConnection</A>&nbsp;connection,
                                double&nbsp;priority)</PRE>
<DL>
<DD>Note that a priority which was previously allocated was not used, and needs to be released.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="noteConnectionPerformance(int, java.lang.String, long)"><!-- --></A><H3>
noteConnectionPerformance</H3>
<PRE>
public void <B>noteConnectionPerformance</B>(int&nbsp;docCount,
                                      java.lang.String&nbsp;connectionName,
                                      long&nbsp;elapsedTime)</PRE>
<DL>
<DD>Note the time required to successfully complete a set of documents.  This allows this module to keep track of
 the performance characteristics of each individual connection, so distribution across connections can be balanced
 properly.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getCurrentStatistics()"><!-- --></A><H3>
getCurrentStatistics</H3>
<PRE>
public <A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/PerformanceStatistics.html" title="class in org.apache.manifoldcf.crawler.interfaces">PerformanceStatistics</A> <B>getCurrentStatistics</B>()</PRE>
<DL>
<DD>Obtain the current performance statistics object
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="beginProcessing(java.lang.String[])"><!-- --></A><H3>
beginProcessing</H3>
<PRE>
public void <B>beginProcessing</B>(java.lang.String[]&nbsp;binNames)</PRE>
<DL>
<DD>Note that we are beginning processing for a document with a particular set of bins.
 This method is called when a worker thread starts work on a set of documents.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="assessMinimumDepth(java.lang.Double[])"><!-- --></A><H3>
assessMinimumDepth</H3>
<PRE>
public void <B>assessMinimumDepth</B>(java.lang.Double[]&nbsp;binNamesSet)</PRE>
<DL>
<DD>Assess the current minimum depth.
 This method is called to provide to the QueueTracker information about the priorities of the documents being currently
 queued.  It is the case that it is unoptimal to assign document priorities that are fundamentally higher than this value,
 because then the new documents will be preferentially queued, and the goal of distributing documents across bins will not be
 adequately met.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>binNamesSet</CODE> - is the current set of priorities we see on the queuing operation.</DL>
</DD>
</DL>
<HR>

<A NAME="endProcessing(java.lang.String[])"><!-- --></A><H3>
endProcessing</H3>
<PRE>
public void <B>endProcessing</B>(java.lang.String[]&nbsp;binNames)</PRE>
<DL>
<DD>Note that we have completed processing of a document with a given set of bins.
 This method gets called when a Worker Thread has finished with a document.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="calculateAssignmentRating(java.lang.String[], org.apache.manifoldcf.crawler.interfaces.IRepositoryConnection)"><!-- --></A><H3>
calculateAssignmentRating</H3>
<PRE>
public double <B>calculateAssignmentRating</B>(java.lang.String[]&nbsp;binNames,
                                        <A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/IRepositoryConnection.html" title="interface in org.apache.manifoldcf.crawler.interfaces">IRepositoryConnection</A>&nbsp;connection)</PRE>
<DL>
<DD>Calculate an assignment rating for a set of bins based on what's currently in use.
 This rating is used to help determine which documents returned from a queueing query actually get made "active",
 and which ones are skipped for the moment.

 The rating returned
 for each bin will be 1 divided by one plus the active thread count for that bin.  The higher the
 rating, the better.  The ratings are combined by multiplying the rating for each bin by that for
 every other bin, and then taking the nth root (where n is the number of bins) to normalize for
 the number of bins.
 The repository connection is used to reduce the priority of assignment, based on the fetch rate that will
 result from this set of bins.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="calculatePriority(java.lang.String[], org.apache.manifoldcf.crawler.interfaces.IRepositoryConnection)"><!-- --></A><H3>
calculatePriority</H3>
<PRE>
public double <B>calculatePriority</B>(java.lang.String[]&nbsp;binNames,
                                <A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/IRepositoryConnection.html" title="interface in org.apache.manifoldcf.crawler.interfaces">IRepositoryConnection</A>&nbsp;connection)</PRE>
<DL>
<DD>Calculate a document priority value.  Priorities are reversed, and in log space, so that
 zero (0.0) is considered the highest possible priority, and larger priority values are considered lower in actual priority.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>binNames</CODE> - are the global bins to which the document belongs.<DD><CODE>connection</CODE> - is the connection, from which the throttles may be obtained.  More highly throttled connections are given
          less favorable priority.
<DT><B>Returns:</B><DD>the priority value, based on recent history.  Also updates statistics atomically.</DL>
</DD>
</DL>
<HR>

<A NAME="calculateMaxFetchRates(java.lang.String[], org.apache.manifoldcf.crawler.interfaces.IRepositoryConnection)"><!-- --></A><H3>
calculateMaxFetchRates</H3>
<PRE>
protected double[] <B>calculateMaxFetchRates</B>(java.lang.String[]&nbsp;binNames,
                                          <A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/IRepositoryConnection.html" title="interface in org.apache.manifoldcf.crawler.interfaces">IRepositoryConnection</A>&nbsp;connection)</PRE>
<DL>
<DD>Calculate the maximum fetch rate for a given set of bins for a given connection.
 This is used to adjust the final priority of a document.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/PerformanceStatistics.AveragingRecord.html" title="class in org.apache.manifoldcf.crawler.interfaces"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../org/apache/manifoldcf/crawler/interfaces/QueueTracker.BinCount.html" title="class in org.apache.manifoldcf.crawler.interfaces"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?org/apache/manifoldcf/crawler/interfaces/QueueTracker.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="QueueTracker.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
